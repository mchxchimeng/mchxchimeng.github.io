[{"title":"findkeys(decode)å®‰å…¨å®éªŒ","url":"/2025/03/21/%E5%AE%89%E5%85%A8%E9%A1%B9%E7%9B%AEfindkeys%EF%BC%88decode%EF%BC%89%E5%A4%A7%E4%B8%80%E4%B8%8A%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C/","content":"å®‰å…¨é¡¹ç›®findkeysï¼ˆdecodeï¼‰é¡¹ç›®è¦æ±‚ä¸»è¦ç›®çš„ï¼šè§£ç æ¶ˆæ¯å¹¶æ‰¾åˆ°å¯†é’¥key1ï¼Œkey2ï¼Œkey3ï¼Œkey4çš„å€¼ï¼Œä»¥ä¸‹æ“ä½œå‡åœ¨64ä½æ¶æ„ä¸‹è¿›è¡Œï¼ˆx86æ¶æ„ä¸‹ä¼šæœ‰ä¸åŒç»“æœä¹Ÿä¼šé™„åˆ°åé¢ï¼‰\n1. æ‰¾åˆ°key12â€˜Fromï¼šâ€™ä»å“ªæ¥ï¼Ÿæç¤ºä¸­å‘Šè¯‰æˆ‘ä»¬å…ˆæ‰¾key1 key2ï¼šattack the keys in two independent parts. Try to break the first two keys first. \nå¹¶ä¸”å‘Šè¯‰æˆ‘ä»¬å¦‚æœkey1key2æ­£ç¡® å¾—åˆ°çš„å¯¹åº”ç»“æœå‰é¢ä¼šå‡ºç°From:    ï¼ˆIf you get the first and second keys right, a message that starts with From: will appear. ï¼‰\næ ¹æ®å»ºè®®ï¼Œå…ˆæ‰¾key12çš„å€¼ï¼Œå…ˆçœ‹process_key12å’Œextract_message12ï¼Œå‰è€…æ˜¯å¯¹æˆ‘ä»¬å³å°†ä¼ å…¥çš„å¯†é’¥å€¼è¿›è¡Œçš„æ“ä½œï¼Œåè€…extract_message12é€šè¿‡è¯»ä»£ç ä¸éš¾å‘ç°å…¶å®å°±æ˜¯è§£å¯†å‡½æ•°ï¼Œè€Œdataå°±æ˜¯å¯†æ–‡\ndataå€¼å¦‚ä¸‹\nint data[] = &#123;       //æ•°æ® å¯†æ–‡0x63636363, 0x63636363, 0x72464663, 0x6F6D6F72,0x466D203A, 0x65693A72, 0x43646E20, 0x6F54540A,0x5920453A, 0x54756F0A, 0x6F6F470A, 0x21643A6F,0x594E2020, 0x206F776F, 0x79727574, 0x4563200A,0x6F786F68, 0x6E696373, 0x6C206765, 0x796C656B,0x2C336573, 0x7420346E, 0x20216F74, 0x726F5966,0x7565636F, 0x20206120, 0x6C616763, 0x74206C6F,0x20206F74, 0x74786565, 0x65617276, 0x32727463,0x6E617920, 0x680A6474, 0x6F697661, 0x20646E69,0x21687467, 0x63002065, 0x6C6C7861, 0x78742078,0x6578206F, 0x72747878, 0x78636178, 0x00783174&#125;;\n\n    å¯ä»¥çœ‹å‡ºå®ƒæ˜¯å¤šä¸ª8ä½16è¿›åˆ¶æ•°ç»„åˆçš„æ•°ç»„ï¼Œ8ä½åå…­è¿›åˆ¶åˆšå¥½æ˜¯32ä½ï¼Œä¹Ÿå°±æ˜¯4å­—èŠ‚ï¼ˆintç±»å‹ï¼‰ã€‚\n    æƒ³è¦å¾—å‡ºå…·æœ‰æœ‰æ„ä¹‰çš„å†…å®¹ï¼Œä¸éš¾æƒ³åˆ°16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªå­—ç¬¦ï¼ˆcharç±»å‹ï¼‰1å­—èŠ‚å¯¹åº”ä¸¤ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œ\n    äºæ˜¯æˆ‘ä»¬å°†å»æ‰0xå‰ç¼€å’Œé€—å·çš„å†…å®¹ç²˜è´´åˆ°è½¬æ¢ç½‘ç«™é‡Œ\n\n6363636363636363724646636F6D6F72466D203A65693A7243646E206F54540A5920453A54756F0A6F6F470A21643A6F594E2020206F776F797275744563200A6F786F686E6963736C206765796C656B2C3365737420346E20216F74726F59667565636F202061206C61676374206C6F20206F747478656565617276327274636E617920680A64746F69766120646E6921687467630020656C6C7861787420786578206F727478787863617800783174\n\n ç„¶è€Œé€šè¿‡åé¢çš„è§£ç å‡½æ•°extract_message12çš„è§£ç é€»è¾‘ï¼ˆæŒ‡å®šæ–¹å¼çš„é¡ºåºè¯»å…¥messageæ¥ç”Ÿæˆæ˜æ–‡ï¼‰çœ‹ï¼Œä»¥ä¸Šè½¬æ¢æ˜¯æ— æ³•å¾—å‡ºæ­£ç¡®çš„è½¬æ¢ç»“æœçš„\n ï¼Œå› ä¸ºå…¶ä¸­å«æœ‰æ— æ³•æ­£å¸¸é˜…è¯»çš„ç¬¦å·\n\n   ğŸ¤”é‚£ä¹ˆé—®é¢˜å‡ºç°åœ¨å“ªé‡Œå‘¢ï¼Œæˆ‘ä»¬ä»¥0x72464663ä¸¾ä¾‹ ï¼Œ7æ˜¯æœ€é«˜ä½ï¼Œ3æ˜¯æœ€ä½ä½ï¼Œè§‚å¯Ÿå†…å­˜å¯ä»¥å‘ç°è¿™ä¸²æ•°åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼æ˜¯  63 46 46 72ï¼ˆå†…å­˜çš„å•ä½æ˜¯å­—èŠ‚ï¼Œä¸¤ä¸ª16è¿›åˆ¶ä¸€ç»„ï¼‰ï¼Œè¿™å«åšå°ç«¯é¡ºåºï¼Œå³ä½ä½åœ°å€åœ¨åœ°å€çš„ä½ä½ï¼ˆåœ°å€æ˜¯ä»ä½åˆ°é«˜çœ‹ï¼Œå‰ä½åé«˜ï¼‰\n\n   æ‰€ä»¥dataçš„è¯»å–æ–¹å¼åº”è¯¥æ˜¯æ¯ç»„æ•°ä»¥ä¸¤ä¸ªæ•°ä¸ºå•ä½ä»åå‘å‰è¯»ï¼Œä¹Ÿå°±æ˜¯0x72 46 46 63ï¼Œ                     \n   åº”è¯¥ä»¥63 46 46 72çš„é¡ºåºè½¬æ¢ï¼Œæ‰€ä»¥è‡ªå·±å†™ä¸€ä¸ªå¯¹åº”çš„è§£ç ç¨‹åº,ä»¥ä¸‹æ˜¯æ­£ç¡®ç»“æœ\n\n\nè½¬æ¢ä»£ç å¦‚ä¸‹ï¼ˆå…¶å®æ˜¯gptå†™çš„ğŸ˜‹ï¼‰\n#include &lt;stdio.h&gt;#include &lt;string.h&gt;void hex_to_string(int *data, size_t len, char *output) &#123;    size_t j = 0;    for (size_t i = 0; i &lt; len; i++) &#123;        // æŒ‰å°ç«¯é¡ºåºå¤„ç†32ä½æ•°æ®ä¸­çš„æ¯ä¸ªå­—èŠ‚        unsigned char byte1 = (data[i] &amp; 0xFF);        unsigned char byte2 = ((data[i] &gt;&gt; 8) &amp; 0xFF);        unsigned char byte3 = ((data[i] &gt;&gt; 16) &amp; 0xFF);        unsigned char byte4 = ((data[i] &gt;&gt; 24) &amp; 0xFF);                // å­˜å‚¨æ¯ä¸ªå­—èŠ‚åˆ°outputå­—ç¬¦ä¸²        output[j++] = byte1;        output[j++] = byte2;        output[j++] = byte3;        output[j++] = byte4;    &#125;    output[j] = &#x27;\\0&#x27;;  // æ·»åŠ å­—ç¬¦ä¸²ç»“æŸç¬¦&#125;int main() &#123;    int data[] = &#123;  // æ•°æ® å¯†æ–‡        0x63636363, 0x63636363, 0x72464663, 0x6F6D6F72,        0x466D203A, 0x65693A72, 0x43646E20, 0x6F54540A,        0x5920453A, 0x54756F0A, 0x6F6F470A, 0x21643A6F,        0x594E2020, 0x206F776F, 0x79727574, 0x4563200A,        0x6F786F68, 0x6E696373, 0x6C206765, 0x796C656B,        0x2C336573, 0x7420346E, 0x20216F74, 0x726F5966,        0x7565636F, 0x20206120, 0x6C616763, 0x74206C6F,        0x20206F74, 0x74786565, 0x65617276, 0x32727463,        0x6E617920, 0x680A6474, 0x6F697661, 0x20646E69,        0x21687467, 0x63002065, 0x6C6C7861, 0x78742078,        0x6578206F, 0x72747878, 0x78636178, 0x00783174    &#125;;        size_t len = sizeof(data) / sizeof(data[0]);  // å¯†æ–‡æ•°æ®çš„å…ƒç´ æ•°é‡    char output[len * 4 + 1];  // å­˜å‚¨è½¬æ¢åçš„å­—ç¬¦ä¸²        hex_to_string(data, len, output);    printf(&quot;è½¬æ¢åçš„å­—ç¬¦ä¸²:\\n%s\\n&quot;, output);        return 0;&#125;\n\n é™¤äº†è‡ªå·±æ•²ä»£ç è½¬æ¢ä¹‹å¤– ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ä¸€ç§ç®€å•æ–¹å¼ç›´æ¥æ‰¾åˆ°è½¬æ¢åçš„ç»“æœ\n\næˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰“æ–­ç‚¹åœ¨ç¨‹åºå†…è°ƒè¯• åœ¨å†…å­˜ä¸­æŸ¥çœ‹&amp;dataçš„å€¼ï¼Œå†…å­˜ä¸­æœ¬æ¥å°±æ˜¯å°ç«¯é¡ºåº æ‰€ä»¥å†…å­˜å³ä¾§å°±æ˜¯æ­£ç¡®çš„è½¬æ¢ç»“æœ\n\nå³ä¾§å°±æ˜¯vsè‡ªåŠ¨å¸®æˆ‘ä»¬è½¬æ¢çš„å¯¹åº”ç»“æœï¼Œæˆªå–æ”¾å¤§å¦‚ä¸‹\n\n\nå¦‚ä½•è¯»å‡ºæ˜æ–‡å¹¶æ‰¾åˆ°keyå€¼ğŸ¤”é€šè¿‡æç¤ºâ€œå¦‚æœä½ æ­£ç¡®åœ°è·å–äº†ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªé”®ï¼Œ å°†æ˜¾ç¤ºä¸€æ¡ä»¥ Fromï¼š å¼€å¤´çš„æ¶ˆæ¯â€\nè€Œextract_message1å‡½æ•°ç»è¿‡è§‚å¯Ÿå°±æ˜¯å¯¹dataè¿›è¡Œè½¬æ¢çš„è§£å¯†å‡½æ•°ï¼Œå®ƒçš„è¿è¡Œéœ€è¦ä¸¤ä¸ªå‚æ•°\nstartï¼ˆèµ·ç‚¹ï¼‰å’Œstrideï¼ˆæ­¥é•¿ï¼‰ï¼Œè€Œè¿™ä¸¤ä¸ªå‚æ•°åˆæ˜¯é€šè¿‡dummyå˜é‡èµ‹å€¼çš„\nè§£ç å‡½æ•°ä»£ç å¦‚ä¸‹\n  char* extract_message1(int start, int stride) &#123;\tint i, j, k;\tint done = 0;\tfor (i = 0, j = start + 1; !done; j++) &#123;         \t\tfor (k = 1; k &lt; stride; k++, j++, i++) &#123;\t\t\tif (*(((char*)data) + j) == &#x27;\\0&#x27;) &#123;  \t\t\t\tdone = 1;\t\t\t\tbreak;\t\t\t&#125;\t\t\tmessage[i] = *(((char*)data) + j);\t\t&#125;\t&#125;\tmessage[i] = &#x27;\\0&#x27;;\treturn message;&#125;\n\n  è§‚å¯Ÿè¿™ä¸ªå‡½æ•°é€»è¾‘ï¼Œmessageæ˜¯æˆ‘ä»¬æœ€åè¦å¾—åˆ°çš„æ˜æ–‡ï¼ˆä»¥ä¸‹ç®€ç§°msgï¼‰ï¼Œstart+1å°±æ˜¯dataå¼€å§‹è¯»å…¥msgçš„ä½ç½®ï¼ˆdataå¼ºæ¢äº†char*ç±»å‹ï¼Œä¸€æ¬¡åªèƒ½è®¿é—®ä¸€ä¸ªå­—ç¬¦ï¼‰ï¼Œé€šè¿‡è¯»å¾ªç¯å¯çŸ¥strideçš„å€¼å½±å“å†…å±‚å¾ªç¯çš„ç»“æŸï¼Œå†…å±‚å¾ªç¯ï¼ˆstride-1ï¼‰æ¬¡ä¹‹åï¼ŒjåŠ åŠ stride-1æ¬¡ï¼Œmsgä¹ŸæŒ‰é¡ºåºè¯»äº†stride-1ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å†…å±‚ç»“æŸådoneä¸º0ç»§ç»­å¾ªç¯ï¼Œæ­¤æ—¶å¤–å±‚å¾ªç¯åˆç»™j++ï¼Œè¿›å…¥å†…å±‚åˆå¼€å§‹j++ï¼Œè€Œå¤–å±‚å¾ªç¯è¿›è¡Œj++çš„æ—¶å€™æˆ‘ä»¬æ²¡æœ‰è¿›è¡Œmsgçš„è¯»å…¥æ“ä½œï¼Œæ‰€ä»¥ä¼šè·³è¿‡dataé‡Œçš„ä¸€ä¸ªå­—ç¬¦åœ¨è¿›è¡Œè¯»å…¥ï¼Œä»¥æ­¤ç±»æ¨ç›´åˆ°é‡åˆ°ç»“æŸç¬¦å·ã€‚\n\n è¿™é‡Œæ’å…¥ä¸€ä¸‹ä¸Šè¿°ä»£ç çš„è½¬æ¢åŠŸèƒ½å®ç°çš„ç»†èŠ‚ï¼šå­—ç¬¦æ˜¯ä»¥ascllç å¯¹åº”çš„å€¼å­˜å‚¨çš„ï¼Œè€Œåœ¨è¾“å‡ºå­—ç¬¦æ—¶ä¼šè‡ªåŠ¨è½¬æ¢æˆå­—ç¬¦è¾“å‡ºï¼Œæ‰€ä»¥ä¸Šè¿°ä»£ç çœ‹ä¼¼æ˜¯è¯»å–æ•°å­—ï¼Œå…¶å®åœ¨printfä¹‹åä¼šè‡ªåŠ¨è½¬æ¢æˆå­—ç¬¦ä¸²\n\n äº†è§£extract_message1å‡½æ•°é€»è¾‘åï¼Œæˆ‘ä»¬æƒ³è¦å®ƒæ­£å¸¸è¿ä½œèµ·æ¥ï¼Œæ ¹æ®â€œå¦‚æœä½ æ­£ç¡®åœ°è·å–äº†ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªé”®ï¼Œ å°†æ˜¾ç¤ºä¸€æ¡ä»¥ Fromï¼š å¼€å¤´çš„æ¶ˆæ¯â€çš„æç¤ºï¼Œå†ç»“åˆè¿™ä¸ªè§£å¯†å‡½æ•°çš„é€»è¾‘æ˜¯ä»ä¸€å®šå¤„å¼€å§‹è¯»stride-1ä¸ªå­—ç¬¦ç„¶åè·³ä¸€ä¸ªå­—ç¬¦å†è¯»stride-1ä¸ªå­—ç¬¦è¿™æ ·å¾ªç¯ å¯ä»¥è¯•å‡º start = 9ï¼Œï¼ˆæ³¨æ„æ•°ç»„çš„èµ·ç‚¹æ˜¯0ï¼‰stride = 3ï¼Œè¿™æ ·ä»ç¬¬äºŒä¸ªFè¯»èµ·ï¼Œæ¯è¯»ä¸¤ä¸ªè·³ä¸€ä¸ªï¼Œå‘ç°åˆšå¥½èƒ½å‡‘å‡ºFrom ï¼š\n\n\n äºæ˜¯æˆ‘ä»¬æƒ³è¦è®©start &#x3D; 9ï¼Œstride &#x3D; 3ï¼Œè€Œè¿™ä¸¤ä¸ªå€¼åˆæ˜¯é€šè¿‡å˜é‡dummyèµ‹å€¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è§‚å¯Ÿdummyå¯¹startï¼Œstrideçš„è½¬æ¢ä»£ç \nstart = (int)(**(((char**)&amp;dummy)));  stride = (int)(**(((char**)&amp;dummy) + 1));\n\nstartï¼š     &amp;dummyä¸ºæ•´æ•°dummyçš„åœ°å€\nç°åœ¨å¼ºè½¬æˆchar*ç±»å‹ ä»4å­—èŠ‚è½¬æ¢æˆ æŒ‡1å­—èŠ‚å€¼çš„åœ°å€ å¹¶ä¸”ä¼šæ˜¯ä½ä½åœ°å€ ç„¶åè§£å¼•ç”¨å¾—åˆ°çš„æ˜¯ä½ä½åœ°å€çš„å€¼ï¼Œæœ€åå¼ºè½¬ä¸ºint ç±»å‹ å› ä¸ºæ˜¯charå€¼å‡int æ‰€ä»¥å€¼ä¸ä¼šäº§ç”Ÿä¸¢å¤±ç­‰å˜åŒ– æ‰€ä»¥startå°±æ˜¯dummyçš„å€¼çš„å‰ä¸€å­—èŠ‚  æ¯”å¦‚dummyæ˜¯ 11 22 33 44 ï¼Œstart &#x3D; 11.æ‰€ä»¥è¦æƒ³start &#x3D; 9ï¼Œdummyæœ€ä½ä½å­—èŠ‚åº”è¯¥æ˜¯09\nstrideï¼š   å…ˆå°†å¼ºè½¬ååœ°å€åŠ  â€˜1â€™å†è§£å¼•ç”¨ï¼Œè¿™é‡Œæ¶‰åŠåˆ°æŒ‡é’ˆçš„åŠ æ³•è¿ç®—\næŒ‡é’ˆåŠ æ³•æ—¶ï¼ŒæŒ‡é’ˆçš„æ­¥é•¿æ˜¯ä¸æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ•°æ®ç±»å‹çš„å¤§å°ï¼Œå¼ºè½¬char*å‹åæ­¥é•¿å˜ä¸º1å­—èŠ‚ï¼Œæ‰€ä»¥strideæ˜¯dummyçš„ç¬¬äºŒä¸ªå­—èŠ‚ï¼Œè¦æƒ³è®©stideä¸º3ï¼Œdummyçš„ç¬¬äºŒä¸ªå­—èŠ‚å°±è¦ä¸º03ï¼Œ\næ‰€ä»¥æ•´å‹å˜é‡dummyåº”è¯¥æ˜¯ 09 03 xx xxï¼Œæ‰èƒ½è®©è§£ç å‡½æ•°æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬è®©dummyä¸º09 03 00 00ï¼Œ\nä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶ä¸‹çš„309ï¼Œé€šè¿‡åå…­è¿›åˆ¶è½¬åè¿›åˆ¶å¯ä»¥å¾—åˆ°dummyä¸º3*256+9&#x3D;777\nç°åœ¨æˆ‘ä»¬æ‰¾åˆ°äº†dummyçš„å€¼ ç„¶è€Œdummyè¢«åˆå§‹åŒ–ä¸º1ï¼Œè¾¾ä¸åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œè“¦ç„¶å›é¦–ï¼Œé¡¹ç›®æç¤ºä¸­æœ‰è¿™å¥è¯\nIn breaking the first two keys, realize that the function must be somehow changing the value of the variable.  because the variables and control the extraction of the message.\nè¿™æŒ‡ç¤ºæˆ‘ä»¬ä¸€å®šè¦æ”¹å˜dummyçš„å€¼then howï¼Ÿå› ä¸ºæˆ‘ä»¬ä¸èƒ½ç›´æ¥æ”¹å˜ä»£ç  æˆ‘ä»¬é™¤äº†åˆ†æå”¯ä¸€èƒ½åšçš„äº‹å°±æ˜¯ä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å‚æ¥æ”¹å˜dummyçš„å€¼ï¼Œæˆ‘ä»¬ä¼ çš„å€¼å°±æ˜¯key1ï¼Œkey2ï¼Œäºæ˜¯ä¹çœ‹processkey_12å‡½æ•°\nvoid process_keys12(int* key1, int* key2) &#123;  **((int**)(key1 + *key1)) = *key2;&#125;\n\nå¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°æ˜¯å¯¹ä¼ å…¥çš„æŒ‡é’ˆkey1 key2è¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬æ¥æ·±å…¥åˆ†æä¸‹è¿™ä¸ªå‡½æ•°ï¼Œ\nkey1æœ¬èº«æ˜¯æŒ‡é’ˆ key1è§£å¼•ç”¨åä¹Ÿå°±æ˜¯å€¼ï¼Œè¿™æ¶‰åŠåˆ°æˆ‘ä»¬åˆšæ‰è¯´çš„æŒ‡é’ˆåŠ æ³•è¿ç®—ï¼Œkey1æ˜¯æŒ‡å‘intç±»å‹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥key1 + key1å®é™…ä¸Šæ˜¯è®©æŒ‡é’ˆæŒ‡å‘çš„åœ°å€å‘åèµ°ï¼ˆ4 ä¹˜ä»¥ ï¼ˆkey1ï¼‰ï¼‰ä¸ªå­—èŠ‚ï¼Œç„¶åæ•´ä½“å†å¼ºè½¬intç±»å‹ï¼Œæœ€åå†è§£å¼•ç”¨ï¼Œå¾—åˆ°çš„æ˜¯ç›¸åº”è®¡ç®—åæŒ‡å‘çš„åœ°å€çš„4ä¸ªå­—èŠ‚çš„å€¼ï¼Œè€Œèµ‹å€¼å¼å­å³ä¾§çš„key2è¢«èµ‹ç»™å·¦ä¾§è¿™ä¸ªå¼å­ï¼Œè€Œkey1ï¼Œkey2æœ¬èº«çš„å€¼æ˜¯ç”±æˆ‘ä»¬ä¼ å…¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥key2çš„å€¼ä½¿å¾—å·¦ä¾§å¼å­è¢«èµ‹æˆæˆ‘ä»¬æƒ³è¦çš„å€¼ï¼Œè€Œkey1çš„å€¼åŒæ ·ä¸ºæˆ‘ä»¬æ‰€ä¼ å…¥ï¼Œå·¦ä¾§ä¼ å…¥key1åå¯ä»¥åœ¨key1çš„åœ°å€ä¸Šåšç§»åŠ¨ä½¿å¾—å·¦ä¾§æŒ‡å‘æŒ‡å®šçš„åœ°å€çš„å€¼ç„¶åè¢«key2èµ‹å€¼ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜key1ï¼Œkey2çš„å€¼æ¥ç”¨è¿™ä¸ªå¼å­æ”¹å˜ä»»æ„å·²çŸ¥åœ°å€å˜é‡çš„å€¼ä¸ºæŒ‡å®šå€¼\näºæ˜¯æˆ‘ä»¬æƒ³ç”¨è¿™ä¸ªå¼å­æ¥æ”¹å˜dummyçš„å€¼ï¼Œæˆ‘ä»¬æ‰“æ–­ç‚¹è°ƒè¯•key12ç›¸å…³çš„ä»£ç ç„¶ååœ¨ç›‘è§†ä¸­å–dummyåœ°å€å’Œkey1åœ°å€\n\n\n\n\n\nåç§°\nå€¼\nç±»å‹\n\n\n\n\n&amp;dummy\n0x000000000014fc14 {1}\nint *\n\n\n\n\n\n\nåç§°\nå€¼\nç±»å‹\n\n\n\n\nkey1\n0x000000000014fc74 {-24}\nint *\n\n\næˆ‘ä»¬å‘ç°key1çš„åœ°å€æ¯”dummyé«˜96ï¼Œæˆ‘ä»¬æƒ³è¦\nkey1 + *key1å‡†ç¡®å®šä½åˆ°dummyçš„åœ°å€ï¼Œæ‰€ä»¥ï¼ˆkey1ï¼‰ * 4 &#x3D;-96 ï¼Œ key1 &#x3D; -24\næˆ‘ä»¬æƒ³è¦dummyèµ‹å€¼ä¸º777ï¼Œæ‰€ä»¥å³ä¾§*key2 &#x3D; 777ã€‚ï¼ˆå¿…é¡»åœ¨64ä½ä¸‹ï¼‰\næˆ‘ä»¬æ‰“å¼€vsçš„é¡¹ç›®å±æ€§ åœ¨è°ƒè¯•ä¸­ä¼ å…¥å‚æ•° -24 ï¼Œ777ï¼Œ 1ï¼Œ1ï¼ˆåé¢key34æœªçŸ¥æ‰€ä»¥éšä¾¿å¡«ï¼‰\nè¿è¡Œå¾—åˆ°ä»¥ä¸‹ç»“æœ\n\nè¯´æ˜key1ï¼Œkey2æ­£ç¡®\n2.What about key3&amp;key4?key1å’Œkey2ç›¸å½“äºä¸€ä¸ªå¼•å¯¼ï¼Œå› ä¸ºkey1ï¼Œkey2ç›¸å…³çš„ä»£ç å’Œkey3ï¼Œkey4å¾ˆå¯¹ä»—ï¼Œå¯ä»¥æƒ³åˆ°key3ï¼Œkey4å°±æ˜¯ä»–ä»¬çš„å‡çº§ç‰ˆ\nåˆ†æå¾—åˆ°çš„æ–°tipæˆ‘ä»¬æ¥çœ‹ç ´è§£å‰ä¸¤ä¸ªå¯†é’¥åçš„å¾—åˆ°çš„æç¤ºä¿¡æ¯\n\næç¤ºè®©æˆ‘ä»¬æ‰¾åˆ°èƒ½å¼ºåˆ¶è°ƒç”¨extract_message2å‡½æ•°è€Œé¿å…è°ƒç”¨extract_message1çš„key3ï¼Œkey4çš„å€¼\nä»¥ä¸‹ä¸ºç›¸å…³éƒ¨åˆ†ä»£ç \nif (key3 != 0 &amp;&amp; key4 != 0) &#123;\tprocess_keys34(&amp;key3, &amp;key4);     ///////////////////&#125;msg1 = extract_message1(start, stride);/**/if (*msg1 == &#x27;\\0&#x27;) &#123;\tprocess_keys34(&amp;key3, &amp;key4);//////////////////////\tmsg2 = extract_message2(start, stride);/**/\tprintf(&quot;%s\\\\n&quot;, msg2);&#125;else &#123;\tprintf(&quot;%s\\\\n&quot;, msg1);&#125;return 0;&#125;\n\nå¯ä»¥çœ‹åˆ°æˆ‘ç”¨&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;æ ‡æ³¨äº†ä¸¤ä¸ªprocess_keys34(&amp;key3, &amp;key4)å‡½æ•°ç”¨&#x2F;**&#x2F;æ ‡æ³¨äº†extract_message1å’Œextract_message2ï¼Œæ ¹æ®æç¤ºæˆ‘ä»¬æƒ³è¦è·³è¿‡æ‰§è¡Œ\nmsg1 &#x3D; extract_message1(start, stride);&#x2F;**&#x2F;è¿™ä¸€å¥\nç„¶åè¿›å…¥ifæ‰§è¡Œmsg2 &#x3D; extract_message2(start, stride);&#x2F;**&#x2F;è¿™ä¸€å¥å°±èƒ½å¾—åˆ°æ­£ç¡®ç­”æ¡ˆ\nextract_message2(start, stride)çš„startå’Œstrideä¿æŒä¸å˜\nå®é™…ä¸Šé€šè¿‡åˆ†æextract_message2(start, stride)çš„ä»£ç  æˆ‘ä»¬å‘ç°å®ƒå’Œextract_message1ç›¸ä¼¼\nchar* extract_message2(int start, int stride) &#123;int i, j;for (i = 0, j = start;**(((char**)data) + j) != &#x27;\\0&#x27;;i++, j += stride)&#123;message[i] = *(((char*)data) + j);&#125;message[i] = &#x27;\\0&#x27;;return message;&#125;\n\nå®ƒçš„è¯»å…¥æ–¹å¼æ˜¯ä»dataçš„ startä½å¼€å§‹å•å±‚å¾ªç¯ æ¯æ¬¡è¯»å…¥ä¸€ä¸ªå­—ç¬¦ç„¶åè·³stride-1ä¸ªå­—ç¬¦ï¼Œå¦‚æœkey1ï¼Œkey2ä¸å˜ï¼Œstart &#x3D; 9ï¼Œstride &#x3D; 3ï¼Œåœ¨è¿™é‡Œå°±æ˜¯ä»ç¬¬9ä¸ªå­—ç¬¦å¼€å§‹è¯»ä¸€ä¸ªè·³è¿‡ä¸¤ä¸ªï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ ·è¯»å…¥ä»ç„¶ä¼šå¾—åˆ°æœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²From ï¼šCTEâ€¦â€¦â€¦â€¦..\n\nè¿™å¯ç¤ºæˆ‘ä»¬ä¸ç”¨æ”¹startï¼Œstrideçš„å€¼å’Œextract_message2ä¹‹åæ€ä¹ˆæ“ä½œå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä¸“ä¸€è¿›è¡Œå¼ºåˆ¶è°ƒç”¨extract_message2å‡½æ•°è€Œé¿å…è°ƒç”¨extract_message1çš„å»ºè®®\nå¦‚ä½•åšåˆ°é¿å…è°ƒç”¨å’Œå¼ºåˆ¶è°ƒç”¨å‡½æ•°ç±»æ¯”  **((int*)*(key1 + *key1)) &#x3D; *key2è¿™ä¸ªå¯ä»¥ä¿®æ”¹ä»»æ„åœ°å€é‡Œçš„å€¼çš„ä¸‡èƒ½å¼å­\n(((int)&amp;key3) + *key3) +&#x3D; *key4 è¿™ä¸ªå¼å­å¯ä»¥è®©æˆ‘ä»¬ä½¿å¾—ä»»æ„åœ°å€é‡Œçš„å€¼åŠ ä¸Š  *key4\næˆ‘ä»¬æ­£æ˜¯éœ€è¦ç”¨åˆ°è¿™ä¸ªå¼å­æ¥åšåˆ°å¼ºåˆ¶è°ƒç”¨å‡½æ•°\nè¿™é‡Œæœ‰ä¸¤ç§å¼ºè¡Œæ­¥å…¥å‡½æ•°çš„æ–¹æ³•\næ–¹æ³•1.ä¿®æ”¹dataå¯¹åº”çš„å€¼æ»¡è¶³ifæ¡ä»¶æ¥æ­¥å…¥æ¡ä»¶åˆ†å¥æ³¨æ„åˆ°ï¼Œå½±å“è°ƒç”¨extract_message1è¿˜æ˜¯2çš„ifæ¡ä»¶å¦‚ä¸‹\nprocess_keys34(&amp;key3, &amp;key4);  &#125;msg1 = extract_message1(start, stride);if (*msg1 == &#x27;\\0&#x27;) &#123;   //è¿™é‡Œå°±æ˜¯åˆ†æ”¯ç‚¹process_keys34(&amp;key3, &amp;key4);msg2 = extract_message2(start, stride);printf(&quot;%s\\n&quot;, msg2);&#125;else &#123;printf(&quot;%s\\n&quot;, msg1);&#125;\n\nå¦‚æœmsg1 &#x3D;&#x3D; â€˜\\0â€™å°±ä¼šæ­¥å…¥æˆ‘ä»¬æƒ³è¦çš„extract_message2å‡½æ•°å¾—åˆ°ç»“æœï¼Œå¦‚æœæˆ‘ä»¬ä¸åšä»»ä½•ä¿®æ”¹ï¼Œä¼šç›´æ¥æ‰§è¡Œelseè¯­å¥æ‰“å°msg1ï¼Œæˆ‘ä»¬æƒ³è¦æ‰“å°msg2ï¼Œå°±éœ€è¦æ»¡è¶³ifæ¡ä»¶è®©msg1&#x3D;â€˜\\0â€™ï¼Œè€Œæˆ‘ä»¬æ­£å¥½æ‹¥æœ‰æ”¹å˜æŒ‡å®šåœ°å€å€¼çš„powerğŸ˜‹\nif I want *msg1 &#x3D;&#x3D; â€˜\\0â€™,then I have to take it.ï¼ˆä¹±å…¥ï¼‰\næƒ³ä¿®æ”¹msg1çš„ç»“æœ æˆ‘ä»¬éœ€è¦å€’å›å»çœ‹çš„è¯»å…¥æ¡ä»¶extract_message1\nchar* extract_message1(int start, int stride) &#123;    int i, j, k;    int done = 0;    for (i = 0, j = start + 1; !done; j++) &#123;        for (k = 1; k &lt; stride; k++, j++, i++) &#123;            if (*(((char*)data) + j) == &#x27;\\0&#x27;) &#123;                done = 1;                break;            &#125;            message[i] = *(((char*)data) + j);        &#125;    &#125;    message[i] = &#x27;\\0&#x27;;    return message;&#125;\n\n if ((((char)data) + j) &#x3D;&#x3D; â€˜\\0â€™)æ˜¯ä¸­å€¼å¾ªç¯çš„ä¸»è¦æ¡ä»¶ï¼Œè€Œjç¬¬ä¸€æ¬¡ä¸ºstart+1&#x3D;10ï¼Œä¹Ÿå°±æ˜¯dataæ•°ç»„çš„ç¬¬åä¸ªå­—èŠ‚ï¼Œå¦‚æœæˆ‘ä»¬æŠŠå®ƒèµ‹å€¼æˆâ€™\\0â€™ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šä»€ä¹ˆéƒ½ä¸è¯»å…¥ï¼Œmessageå°±ä¼šé»˜è®¤ä¸ºç©ºï¼Œ\n*msg1 &#x3D;&#x3D; â€˜\\0â€™å°±ä¼šæˆç«‹\næ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯è¿ç”¨key3ï¼Œkey4æ¥ä¿®æ”¹æŒ‡å®šå€¼çš„æ—¶æœºäº†\n(((int)&amp;key3) + *key3) +&#x3D; *key4&#x2F;&#x2F;æ³¨æ„æ˜¯ +&#x3D;\næˆ‘ä»¬å–dataåœ°å€ï¼Œå°†å…¶ç¬¬åä¸ªå­—ç¬¦æ”¹å˜ä¸º \\0  ï¼ˆascllé‡Œçš„00ï¼‰&#x2F;&#x2F;æ³¨æ„æ˜¯æ•°ç»„çš„10ï¼ˆä»0å¼€å§‹ï¼‰\nç›´æ¥åœ¨å†…å­˜çª—å£é‡Œè¾“å…¥&amp;dataå›è½¦\n\næˆ‘ä»¬æƒ³æ”¹ç¬¬10ä¸ªå­—èŠ‚ 46 ä¸º 00 ï¼Œæˆ‘ä»¬çš„ä¿®æ”¹æ˜¯intç±»å‹çš„ï¼Œä¸€æ¬¡ä¿®æ”¹4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æ‰¾åˆ°data[2]çš„å†…å­˜ä½ç½®0x0000000140006088 å°†63 46 46 72ï¼ˆ0x72464663ï¼‰ æ”¹ä¸º63 46 00 72 ï¼ˆ0x72004663ï¼‰ä¹Ÿå°±æ˜¯è®©*key4 &#x3D; ä¸¤æ•°ç›¸å‡ä¸º-4,587,520\næ¥ä¸‹æ¥ç®—key3 ï¼ˆï¼ˆint*ï¼‰&amp;key3 + *key3ï¼‰åº”è¯¥è¡¨ç¤ºdata[2]çš„åœ°å€0x0000000140006088 \n&amp;key3çš„å€¼åœ¨å†…å­˜ä¸­æŸ¥çœ‹å¾—åˆ°ä¸º0x000000000014fbf0  æ³¨æ„æ˜¯&amp;key3 ä¸æ˜¯key3\næˆ‘ä»¬è®©0x000000000014fbf0 +ï¼ˆ*key3 ï¼‰ *4 &#x3D; 0x0000000140006088 ï¼ˆæŒ‡é’ˆè¿ç®—æ³•åˆ™ï¼‰\nç»è¿‡è®¡ç®—å¾—åˆ°*key3 &#x3D; 5367358616&#x2F;4&#x3D;1341839654  \n&#x2F;&#x2F;è¿™ç§æ–¹æ³•çš„*key4åº”è¯¥ä¸€è‡´ï¼Œkey3åœ°å€åç§»é‡ä¼šæ ¹æ®æœºå™¨ä¸åŒè€Œä¸åŒ\næˆ‘ä»¬å°†å››ä¸ªå€¼ä¼ å…¥è¿è¡Œ \n\n\næœ€åç»“æœå¦‚ä¸Š è¿™ä»£è¡¨æˆ‘ä»¬ä¼ å…¥çš„å››ä¸ªå€¼éƒ½æ­£ç¡®\næ–¹æ³•2 åˆ©ç”¨æ ˆå¸§åˆ†ææ”¹å˜å‡½æ•°çš„è¿”å›åœ°å€å†æ¬¡å¼ºè°ƒ 64ä½å’Œx86ç»“æœä¸åŒ ä¸è¿‡ä¸¤ç§æƒ…å†µä¸‹çš„åˆ†ææ–¹æ³•ç›¸åŒ\næˆ‘ä»¬å›åˆ°æ‰¾key3ï¼Œkey4è¦è§£å†³çš„é—®é¢˜ï¼šå¼ºåˆ¶è°ƒç”¨extract_message2å‡½æ•°è€Œé¿å…è°ƒç”¨extract_message1\nä¸Šä¸€ç§æ–¹æ³•æˆ‘ä»¬ç”¨çš„ä»£ç é‡Œç»™çš„ifè¯­å¥ä¿®æ”¹å€¼æ»¡è¶³æ¡ä»¶æ­¥å…¥extract_message2ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¿®æ”¹å‡½æ•°çš„è¿”å›åœ°å€çš„æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„ ï¼Œè¿™éœ€è¦ä¸€ç‚¹æ ˆå¸§ç»“æ„çš„çŸ¥è¯† \nã€Cç¨‹åºåœ¨å†…å­˜ä¸­çš„æ ˆã€‘ https://www.bilibili.com/video/BV1By4y1x7Yh/?share_source&#x3D;copy_web&amp;vd_source&#x3D;d8b8c07d289d045ecef7ba91bfa51e69\n64ä½ä¸‹æ ˆé¡¶ä¸ºRSP æ ˆåº•ä¸ºRBP\nx86ä¸‹æ ˆé¡¶ä¸ºESP æ ˆåº•ä¸ºEBP \nåœ¨ä¸€ä¸ªå‡½æ•°çš„åæ±‡ç¼–çš„ä»£ç æœ«å°¾å¤„ æ ˆé¡¶RSPä¼šæŒ‡å‘å‡½æ•°çš„è¿”å›åœ°å€ æˆ‘ä»¬åªéœ€è¦è®°ä½è¿™ä¸€ç‚¹å°±èƒ½åˆ†æ\nè¿™æ¬¡éœ€è¦æˆ‘ä»¬æ‰“å¼€å¯„å­˜å™¨å’Œåæ±‡ç¼–\næˆ‘ä»¬åœ¨process_keys34å¤„æ‰“æ–­ç‚¹ è°ƒè¯•åˆ°è¿™ä¸€æ­¥çš„æ—¶å€™ä¼šæ­¥å…¥process_keys34çš„å®šä¹‰\nè°ƒè¯• \n\n\nåœ¨åæ±‡ç¼–ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªprocess_keys34çš„åæ±‡ç¼–ä»£ç  ä»–ä»¬å¯¹åº”çš„æœ€åä¸€æ¡ä»£ç å·¦ä¾§çš„åœ°å€å°±æ˜¯è¿”å›åœ°å€æ‰€åœ¨åœ°å€ï¼Œæˆ‘ä»¬æ‰€åšçš„å°±æ˜¯å°†ç¬¬ä¸€ä¸ªä»£ç çš„è¿”å›åœ°å€æ”¹æˆåˆ°ç¬¬äºŒä¸ªä»£ç çš„è¿”å›åœ°å€ï¼Œè¿™æ ·å°±èƒ½å®ç°æ­¥å…¥extract_message2å‡½æ•°\nå¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªprocess_keys34è¿”å›åœ°å€æ˜¯0000000140001533 \n           ç¬¬äºŒä¸ªprocess_keys34è¿”å›åœ°å€æ˜¯0000000140001567\n\nä¸¤è€…ç›¸å·®52ï¼ˆæ³¨æ„æ˜¯16è¿›åˆ¶å•Šå–‚ï¼‰ä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦å°†å­˜æ”¾è¿”å›åœ°å€çš„æŒ‡é’ˆé‡Œçš„å€¼åŠ 52\nä¸Šé¢å·²ç»æåˆ° è¿™ä¸ªå­˜æ”¾è¿”å›åœ°å€çš„æŒ‡é’ˆå°±æ˜¯æ ˆé¡¶RSP æ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹å¯„å­˜å™¨RSPçš„å€¼\nç‚¹å‡»åæ±‡ç¼–çª—å£ä½¿å¾—è°ƒè¯•è¿‡ç¨‹åœ¨åæ±‡ç¼–ä¸­è¿›è¡Œ ä¸€æ­¥æ­¥è°ƒè¯•çŸ¥é“è½¬åˆ°process_keys34çš„å®šä¹‰ åœ¨è°ƒè¯•ç®­å¤´æŒ‡å‘å®šä¹‰æœ€åçš„retå¤„æ—¶æŸ¥çœ‹å¯„å­˜å™¨RSP\n\næ­¤æ—¶æŸ¥çœ‹å¯„å­˜å™¨RSP&#x3D;000000000014FBE8 è¿™ä¸ªåœ°å€å­˜æ”¾çš„å°±æ˜¯ç¬¬ä¸€ä¸ªå‡½æ•°processçš„è¿”å›åœ°å€\n\né€šè¿‡æŸ¥çœ‹å†…å­˜ä¹Ÿå¯ä»¥éªŒè¯è¿™ä¸€ç‚¹\n\nåˆšå¥½å°±æ˜¯0000000140001533 å’Œåˆšæ‰ç¬¬ä¸€ä¸ªprocesså‡½æ•°è¿”å›åœ°å€ç›¸åŒ\næ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬å°±åˆ©ç”¨poweræ”¹å˜RSPçš„å€¼ è®©ä»–åŠ ä¸Š52\næˆ‘ä»¬åˆå›åˆ°äº†key3 key4çš„è¿™ä¸ªå¼å­\n\nè®©*key4 &#x3D; 52 ï¼ˆå…¶å®ä¹Ÿå¯ä»¥æ˜¯53ï¼Œå› ä¸ºprocee_key34æœ€åä¸€æ¡æ±‡ç¼–æŒ‡ä»¤æœ¬èº«å°±æ˜¯ç©ºæŒ‡ä»¤nop ä¸æ‰§è¡Œä¹Ÿæ²¡å…³ç³»ï¼‰\nè®©(key3 + ((int)&amp;key3))) ä¸ºRSPåœ°å€000000000014FBE8\næŸ¥çœ‹&amp;key3ä¸º000000000014fbf0 é€šè¿‡æŒ‡é’ˆè¿ç®— 4*ï¼ˆ*key3ï¼‰+&amp;key3 &#x3D; 000000000014FBE8\næ±‚å¾—*key3 &#x3D;-2ï¼ˆæ³¨æ„è´Ÿå·ï¼‰\næ‰€ä»¥æ­¤æ—¶*key3 &#x3D; -2 *key4 &#x3D; 52æˆ–53\n\nè¿è¡Œå‘ç°ä¹Ÿèƒ½å¾—å‡ºç›¸åº”æ­£ç¡®ç»“æœ\n\næ€»ç»“è¡¥å……1.x86æ¶æ„ä¸‹ç”¨ä¿®æ”¹å‡½æ•°è¿”å›åœ°å€æ–¹æ³•åšå‡ºçš„ç»“æœå¦‚ä¸‹\n\nå…¶å®777ï¼ˆ *key2æˆ–dummyçš„å€¼ï¼‰æœ‰å¾ˆå¤šç§æƒ…å†µ å› ä¸ºstart å’Œstrideåªå–äº†å®ƒçš„ç¬¬ä¸€å­—èŠ‚å’Œç¬¬äºŒå­—èŠ‚åœ°å€ å‰©ä¸‹çš„ä¸¤ä¸ªå­—èŠ‚åœ°å€å‡å¯ä»¥ä»»æ„å¡«å……\n2.å¿ƒå¾—ä½“ä¼š \næç¤ºå»ºè®®çš„ä½œç”¨å¾ˆå¤§ æ¯”å¦‚æ”¹å˜dummyå˜é‡çš„å€¼å’Œæ­¥å…¥extract_message2å‡½æ•°è¿™ä¸¤ä¸ªæç¤º\nè¿˜æœ‰è¿™ä¸¤ä¸ªæˆ‘ä»¬çš„ä½œç”¨å¼å­\nvoid process_keys12(int* key1, int* key2) &#123;**((int**)(key1 + *key1)) = key2;&#125;void process_keys34(int key3, int* key4) &#123;**(((int**)&amp;key3) + *key3) += *key4;&#125;\n\næœ‰äº†è¿™ä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥æ”¹å˜ä»»æ„å˜é‡çš„å€¼  è¿˜è®°å¾—æˆ‘ç†è§£è¿™ä¸ªå¼å­çš„ä½œç”¨æ—¶çš„å–œæ‚¦ï¼Œæ„Ÿè§‰æ‹¥æœ‰äº†å¸•ç“¦ï¼Œç®€ç›´æ˜¯è¶…æ¨¡ğŸ˜‹\n3.æ ˆå¸§ç»“æ„çš„å…¥é—¨å¤ªç®€å•äº†ï¼Œæ ¹æœ¬æ— æ³•ç‹¬ç«‹åšé¢˜ï¼Œå¸Œæœ›ä»¥åè€å¸ˆç»™çš„çš„å…¥é—¨æ•™ç¨‹èƒ½å¤šä¸€ç‚¹\n4.ä¸åŒçš„ç¯å¢ƒä¸‹çš„ç»“æœä¸åŒï¼Œä¸åŒçš„æ–¹æ³•ç»“æœä¹Ÿä¸åŒï¼Œé¢˜ç›®çš„è§£ç­”å¤šæ ·åŒ–ï¼Œå¾ˆå¥½åœ°ä½“ç°äº†æˆ‘ä»¬é¢å‘å®é™…çš„ç†å·¥ç§‘æ€§è´¨ï¼Œç°å®æƒ…å†µåªä¼šæ›´åŠ å¤æ‚\nå‚è€ƒèµ„æ–™è¿™é¢˜çš„æ€è·¯ä¸»è¦æ€»ç»“äº†å‰å‡ ä½å­¦é•¿çš„æ€è·¯æ–¹æ³•ï¼Œåšå®¢é“¾æ¥æˆ–è§†é¢‘é“¾æ¥å¦‚ä¸‹\nã€Cè¯­è¨€ã€‘SCUå®‰å…¨é¡¹ç›®1-FindKeys_findkeyscè¯­è¨€-CSDNåšå®¢\nå››å·å¤§å­¦ç¨‹åºè®¾è®¡åŸºç¡€(Cè¯­è¨€)ä¸å®‰å…¨ å®‰å…¨é¡¹ç›®è®²è§£ï¼ˆlab1 Decodeé¡¹ç›®ï¼‰_å“”å“©å“”å“©_bilibili\nã€å››å·å¤§å­¦ç½‘å®‰ã€‘Lab1-Decodeï¼ˆç½‘å®‰å¤§ä¸€ä¸ŠCè¯­è¨€ä½œä¸šï¼‰_å“”å“©å“”å“©_bilibili\n","categories":["SCUå®‰å…¨å®éªŒ"],"tags":["SCUå®‰å…¨å®éªŒ"]},{"title":"deadbeefå®‰å…¨å®éªŒ","url":"/2025/03/21/%E5%AE%89%E5%85%A8%E9%A1%B9%E7%9B%AEdeadbeef%E6%8A%A5%E5%91%8A%20%E5%A4%A7%E4%B8%80%E4%B8%8A%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C/","content":"å®‰å…¨é¡¹ç›®deadbeefæŠ¥å‘Šå¼€å§‹é¡¹ç›®ä¹‹å‰vsé¡¹ç›®å±æ€§ä¸­ä¸€å®šè¦å…³æ‰å®‰å…¨æ£€æŸ¥å’ŒéšæœºåŸºå€\n\n\nä»¥ä¸‹æ“ä½œåœ¨x86ç¯å¢ƒä¸‹è¿›è¡Œ\nä»£ç å®¡è®¡é¡¹ç›®æºç \n/* bufbomb.c* Bomb program that is solved using a buffer overflow attack* program for CS:APP problem 3.38* used for CS 202 HW 8 part 2** compile using:* gcc -g -O2 -Os -o bufbomb bufbomb.c*/#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;ctype.h&gt;/* Like gets, except that characters are typed as pairs of hex digits.   Nondigit characters are ignored. Stops when encounters newline */char *getxs(char *dest) &#123;    int c;    int even = 1; /* Have read even number of digits */    int otherd = 0; /* Other hex digit of pair */    char *sp = dest;    while ((c = getchar()) != EOF &amp;&amp; c != &#x27;\\n&#x27;) &#123;        if (isxdigit(c)) &#123;            int val;            if (&#x27;0&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;9&#x27;)                val = c - &#x27;0&#x27;;            else if (&#x27;A&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;F&#x27;)                val = c - &#x27;A&#x27; + 10;            else                val = c - &#x27;a&#x27; + 10;            if (even) &#123;                otherd = val;                even = 0;            &#125; else &#123;                *sp++ = otherd * 16 + val;                even = 1;            &#125;        &#125;    &#125;    *sp++ = &#x27;\\0&#x27;;    return dest;&#125;int getbuf() &#123;    char buf[16];    getxs(buf);    return 1;&#125;void test() &#123;    int val;    printf(&quot;Type Hex string:&quot;);    val = getbuf();    printf(&quot;getbuf returned 0x%x\\n&quot;, val);&#125;int main() &#123;    int buf[16];    /* This little hack is an attempt to get the stack to be in a       stable position */    int offset = (((int) buf) &amp; 0xFFF);    int *space = (int *) malloc(offset);    space = 0; /* So that don&#x27;t get complaint of unused variable */    test();    return 0;&#125;\n\nä»£ç å®ç°äº†å®šä¹‰ä¸€ä¸ªç±»ä¼¼getsï¼ˆè¢«åˆ—ä¸ºä¸å®‰å…¨å‡½æ•°ï¼‰çš„getxså‡½æ•°æ¥è¯»å…¥16å­—èŠ‚16è¿›åˆ¶å­—ç¬¦å­˜å…¥buf[]æ•°ç»„ä¸­ï¼Œå¹¶ä¸”getxsä¼šè¯»å…¥åœ°å€deståä¸”æ— é•¿åº¦é™åˆ¶ï¼Œè¿™å°±æœ‰ç¼“å†²åŒºæº¢å‡ºçš„é£é™©ï¼Œæˆ‘ä»¬è¿è¡Œä»£ç ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸²å­—ç¬¦ï¼Œå‘ç°éƒ½ä¼šè¿”å›0x1ï¼Œè¿™æ˜¯å› ä¸ºæœ€åä¼šæ‰“å°0x+valçš„å€¼ï¼Œè€Œvalè¢«èµ‹å€¼ä¸ºgetbufçš„è¿”å›å€¼ï¼Œè¿™ä¸ªè¿”å›å€¼ä¸º1ã€‚\næ˜ç¡®ç›®çš„æˆ‘ä»¬æƒ³è¦ç¨‹åºè¾“å‡º0xdeadbeefï¼Œå°±è¦è®©valçš„å€¼ä¸ºdeadbeefï¼Œå¹¶ä¸”è·³è¿‡getbufï¼ˆï¼‰å¯¹valçš„èµ‹å€¼æ“ä½œ\nç›´æ¥è¿›è¡Œæ‰“å°æ“ä½œï¼ˆéœ€è¦æŸ¥çœ‹åæ±‡ç¼–ï¼‰ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦åˆ©ç”¨ç¼“å†²åŒºæº¢å‡ºæ¥å®Œæˆè¿™ä¸€æ“ä½œã€‚\nå…·ä½“å®ç°æˆ‘ä»¬åœ¨val &#x3D; getbufï¼ˆï¼‰èµ‹å€¼æ“ä½œå¤„æ‰“æ–­ç‚¹è°ƒè¯•\næœ‰äº†ç¬¬ä¸€é¢˜çš„ä¿®æ”¹è¿”å›åœ°å€çš„åŸºç¡€ æˆ‘ä»¬çš„ç›®çš„åº”è¯¥å¾ˆæ˜æ˜ç¡®ï¼Œ getbufï¼ˆï¼‰å‡½æ•°è¿”å›åœ°å€åŸæ¥åº”è¯¥åœ¨è¿™å¥èµ‹å€¼è¯­å¥ï¼Œæˆ‘ä»¬è¦è®©getbufè¿”å›åœ°å€è·³è¿‡èµ‹å€¼ï¼Œç›´æ¥è¿›è¡Œprintfæ“ä½œï¼ŒæŸ¥çœ‹åæ±‡ç¼–\ngetbufï¼ˆï¼‰è¿”å›åœ°å€ä¸º00401186\næˆ‘ä»¬æƒ³è¦å®ƒè·³åˆ°èµ‹å€¼åçš„printfçš„ç¬¬ä¸€ä¸ªè¯­å¥ 00401189\n\næˆ‘ä»¬åªèƒ½é€šè¿‡ç¼“å†²åŒºæº¢å‡ºçš„æ–¹æ³•ä¿®æ”¹æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ€è€ƒå¦‚ä½•åˆ©ç”¨æº¢å‡ºæ¥ä¿®æ”¹è¿”å›åœ°å€å’Œå¯¹valèµ‹å€¼ï¼Œå‡½æ•°çš„è¿”å›åœ°å€å­˜åœ¨å¯„å­˜å™¨æ ˆé¡¶ESPä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŸ¥çœ‹å¯„å­˜å™¨\nä»ä»val &#x3D; getbufï¼ˆï¼‰ï¼›å¤„è°ƒè¯•ï¼ŒæŸ¥çœ‹å¯„å­˜å™¨ï¼Œå‘ç°æ ˆåº•EBP  &#x3D; 0019FED8 æ ˆé¡¶ ESP &#x3D; 0019FED4,\næ¥ç€è°ƒè¯•å‘ç°æ ˆé¡¶å…ˆä¸Šå‡åˆ°0019FED0,æ ˆåº•ä¸å˜ï¼ˆä¸Šä½åœ°å€ï¼Œä¸‹é«˜åœ°å€ï¼‰ï¼Œå†é€è¯­å¥åˆ°getxså¤„ï¼Œå‘ç°ESPå˜ä¸º0019FEBC,EBPå˜ä¸º0019FECC(æ­¤æ—¶æŸ¥çœ‹å†…å­˜åœ°å€å¯ä»¥å‘ç°å…¶å‚¨å­˜çš„å€¼å°±æ˜¯ä¸Šæ¬¡EBPçš„åœ°å€0019FED8)\næ¥ç€åœ¨åæ±‡ç¼–ä¸­è°ƒè¯• æˆ‘ä»¬é€è¯­å¥ï¼Œåœ¨å¼¹å‡ºçš„å‘½ä»¤çª—å£éšä¾¿å¡«äº›æ•°å­—ï¼Œç›´åˆ°ç®­å¤´æŒ‡å‘getbufå®šä¹‰ä¸­çš„retå¤„\n\næ­¤æ—¶æŸ¥çœ‹ESPåœ°å€ï¼Œæˆ‘ä»¬çŸ¥é“æ­¤æ—¶è¯¥åœ°å€å­˜æ”¾çš„å°±æ˜¯getbufçš„è¿”å›åœ°å€æŸ¥çœ‹å†…å­˜å‘ç°ç¡®å®æ˜¯00401186\nESPåœ°å€ä¸º0019FED0ï¼ŒEBPä¸º0019FED8ï¼Œå¦‚æ­¤æˆ‘ä»¬ä¾¿äº†è§£äº†æ ˆçš„å˜æ¢è¿‡ç¨‹å’Œå‡½æ•°è¿”å›åœ°å€çš„ä½ç½®\næ¥ä¸‹æ¥çœ‹valå’Œbufçš„ç›¸å¯¹ä½ç½®ä»¥ä¾¿æˆ‘ä»¬å°†char buf[16]çš„å€¼è¿›è¡Œæ‰©å†™ï¼Œè¦†ç›–æ‰æ ˆä¸­è¿”å›åœ°å€å’Œä¿®æ”¹valçš„å€¼ã€‚\næŸ¥çœ‹valçš„åœ°å€ä¸º 0x0019FED4 bufçš„åœ°å€ä¸º0019FEBCï¼Œå®ƒä¼šå­˜å‚¨16ä¸ªå­—èŠ‚\næˆ‘ä»¬æ¥ç”»æ ˆå›¾\n\né€šè¿‡ç”»å‡ºæ ˆå›¾æˆ‘ä»¬æ¸…æ™°çš„è®¤è¯†åˆ°å„ä¸ªå†…å­˜åœ°å€çš„ç›¸å¯¹ä½ç½®ï¼Œæˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ¥å†™payloadä¼ å‚\né¦–å…ˆè¦å†™32ä¸ªåå…­è¿›åˆ¶æ•°å­— 12345678123456781234567812345678\nä¹‹åæ˜¯ç¼“å†²åŒºæº¢å‡ºçš„å†…å®¹EBPæ˜¯æ ˆåº• é˜²æ­¢æ ˆç´Šä¹±ï¼ŒEBPä¸èƒ½ä¿®æ”¹ï¼Œæˆ‘ä»¬ä»ç„¶å¡«å…¥0019FED8ï¼Œä¸è¿‡ç”±äºæ˜¯å°ç«¯å­˜å‚¨ï¼Œæˆ‘ä»¬ä¼ å‚çš„æ—¶å€™è¦ä¼ å…¥ D8 FE 19 00 \nå†å¾€åæ˜¯ESP ä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„è¿”å›åœ°å€å¤„ï¼Œæ­¤å¤„æ”¹ä¸º 89 11 40 00\nç„¶åæ˜¯valçš„å€¼ æˆ‘ä»¬å¡«å…¥deadbeef ä¹Ÿå°±æ˜¯ ef be ad de\nä»¥ä¸Šå°±æ˜¯æ‰€æœ‰å¡«å…¥å†…å®¹ï¼Œæ•´åˆåˆ°ä¸€èµ·ï¼š12345678123456781234567812345678D8FE190089114000efbeadde\n\nä¼ å…¥å‚æ•°åå‘ç°å¾—åˆ°ç­”æ¡ˆ\næ€»ç»“  deadbeefé¡¹ç›®è¦æ±‚ä¸€å®šçš„æ ˆå¸§çŸ¥è¯†ï¼ˆæœ‰ä½†ä¸å¤šï¼‰ï¼Œè¿™ä¸ªé¡¹ç›®çš„ä»£ç é‡è¾ƒå°‘ï¼Œæ“ä½œä¹Ÿæ¯”è¾ƒå°‘ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n\n  åšå®Œä¹‹åæ€è€ƒğŸ¤” \n\n   ä¸ºå•¥è¦å¡«deadbeef æœ‰å¦‚æ­¤ç¥åŠ› å¡«ä¸ªæ­»ç‰›è‚‰æœ‰å•¥ç”¨ï¼Ÿ\n\n    DEADBEEFæ˜¯ä¸€ä¸ªè‘—åçš„åå…­è¿›åˆ¶é­”æ•°ï¼ˆMagic Numberï¼‰ã€‚è™½ç„¶çœ‹èµ·æ¥åƒ&quot;æ­»ç‰›è‚‰&quot;çš„è‹±æ–‡ï¼Œä½†å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è°ƒè¯•æ ‡è®°å€¼0xDEADBEEFã€‚è¿™ä¸ªæ•°å€¼æœ€æ—©ç”±IBMçš„RS/6000ç³»ç»Ÿå¼•å…¥ï¼Œç”¨äºæ ‡è®°å·²åˆ†é…ä½†æœªåˆå§‹åŒ–çš„å†…å­˜åŒºåŸŸï¼Œå¸®åŠ©å¼€å‘äººå‘˜åœ¨è°ƒè¯•æ—¶å¿«é€Ÿè¯†åˆ«å†…å­˜çŠ¶æ€ã€‚\n\nåœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­ï¼ŒDEADBEEFçš„ä½¿ç”¨éå¸¸å¹¿æ³›ï¼š\n\næ“ä½œç³»ç»Ÿåº”ç”¨\nMac OSï¼ˆ32ä½PowerPCï¼‰ç”¨å®ƒæ ‡è®°æœªåˆå§‹åŒ–å†…å­˜\nSolarisç³»ç»Ÿå°†å…¶ç”¨ä½œå†…æ ¸ç©ºé—²å†…å­˜æ ‡è®°\n\n\nè°ƒè¯•åœºæ™¯\nåµŒå…¥å¼ç³»ç»Ÿä¸­ç”¨ä½œå´©æºƒæˆ–æ­»é”æŒ‡ç¤ºå™¨\nå†…å­˜è°ƒè¯•å·¥å…·ä¸­çš„å¸¸ç”¨æ ‡è®°å€¼\n\n\n\nè¿™ç±»ç‰¹æ®Šçš„åå…­è¿›åˆ¶æ•°è¢«ç§°ä¸ºâ€é­”æ•°â€ï¼ˆMagic Numberï¼‰ï¼Œå®ƒä»¬åœ¨ç¨‹åºè®¾è®¡ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚ä¾‹å¦‚ï¼ŒVisual C++ä½¿ç”¨0xCCå¡«å……æœªåˆå§‹åŒ–å†…å­˜ï¼Œè¿™ä¸ªå€¼åœ¨Unicodeä¸­æ°å¥½å¯¹åº”ä¸­æ–‡å­—ç¬¦â€çƒ«â€ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆVC++è°ƒè¯•æ—¶ç»å¸¸èƒ½çœ‹åˆ°ä¸€ä¸²â€çƒ«â€å­—çš„åŸå› ã€‚\n","categories":["SCUå®‰å…¨å®éªŒ"],"tags":["SCUå®‰å…¨å®éªŒ"]}]